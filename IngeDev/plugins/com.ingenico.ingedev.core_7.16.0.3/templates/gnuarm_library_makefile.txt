#*******************************************************************************
#* %MAKEFILE_FILE_NAME%
#*------------------------------------------------------------------------------
#* Makefile used to generate the library binary (GNU ARM format).
#* This file was automatically generated by IngeDev. Please, do not edit!
#*******************************************************************************

#-------------------------------------------------------------------------------
# Include variables list set in the runtime-workspace - updated by IngeDev
#-------------------------------------------------------------------------------
include vars.mk
include %OS_VARS_MK_FILE%

#-------------------------------------------------------------------------------
# Include variables list set for all projects used to import libraries/common 
# modules - updated by IngeDev
#-------------------------------------------------------------------------------
%PROJECTS_VARS_MK_FILE%
#-------------------------------------------------------------------------------
# General constants
#-------------------------------------------------------------------------------
EMPTY :=
SPACE := $(EMPTY) $(EMPTY)

#-------------------------------------------------------------------------------
# Project and file names - updated by IngeDev
#-------------------------------------------------------------------------------
# Project name
PROJECT_NAME    = %PROJECT_NAME%
# Sub-Project name
SUB_PRJ_NAME    = %SUB_PROJECT_NAME%
# Config name
CFG_NAME        = %CONFIG_NAME%
# Target file name
TRG_FILE_NAME   = %TARGET_FILE_NAME%

#-------------------------------------------------------------------------------
# Directories - updated by IngeDev
#-------------------------------------------------------------------------------
# Binaries directory
BIN_DIR         = %BIN_DIR%
# Object directory
OBJ_DIR         = %OBJ_DIR%
# Additional libraries object directory 
# (set to blank string if no additional libraries)
ADD_LIBS_OBJ_DIR= %ADD_LIBS_OBJ_DIR%

#-------------------------------------------------------------------------------
# Input files path for the current sub-project in the current config
#-------------------------------------------------------------------------------
# Sub-project configuration path
CFG_PATH        = $(SUB_PRJ_NAME)/$(CFG_NAME)

#-------------------------------------------------------------------------------
# Output files path for the current sub-project in the current config
#-------------------------------------------------------------------------------
# Object files path
OBJ_PATH        = $(OBJ_DIR)/$(SUB_PRJ_NAME)/$(CFG_NAME)
# Binary files path
BIN_PATH        = $(BIN_DIR)/$(CFG_NAME)
# Additional libraries object files path
ADD_LIBS_OBJ_PATH= $(OBJ_PATH)/$(ADD_LIBS_OBJ_DIR)

#-------------------------------------------------------------------------------
# Include additional makefiles - updated by IngeDev
#-------------------------------------------------------------------------------
%ADDITIONAL_MK_FILES%

#-------------------------------------------------------------------------------
# Compiler, assembler, archiver
#-------------------------------------------------------------------------------
# Gnu Compiler executable
CC              = arm-elf-gcc.exe
# Gnu Assembler executable
AS              = arm-elf-as.exe
# Gnu Archiver executable
AR              = arm-elf-ar.exe
# Gnu Archive index generator executable
RN              = arm-elf-ranlib.exe
# Strip debug symbol executable
STRIP           = arm-elf-strip.exe -g

#-------------------------------------------------------------------------------
# Gnu Win32 tools
#-------------------------------------------------------------------------------
# Remove tool
RM              = rm.exe -fr
# Make directory tool
MKDIR           = mkdir.exe -p
# Copy tool
CP              = cp.exe
# Printf tool
PRINTF          = printf.exe

#-------------------------------------------------------------------------------
# Includes path used in compilation process - updated by IngeDev
#-------------------------------------------------------------------------------
INCLUDES_PATH   = \
%USER_INCLUDES_PATH%
$(GNU_ARM_SYS_INC_PATH)

#-------------------------------------------------------------------------------
# Libraries to be included in archive library - updated by IngeDev
#-------------------------------------------------------------------------------
LIBS            = \
%ADDITIONAL_LINKED_LIBS%
%ADDITIONAL_SYST_LIBS%

#-------------------------------------------------------------------------------
# Archive library result output file
#-------------------------------------------------------------------------------
LIB_FILE         = $(OBJ_PATH)/$(TRG_FILE_NAME)
LIB_FILE_NO_SYMB = $(OBJ_PATH)/_$(TRG_FILE_NAME)

#-------------------------------------------------------------------------------
# Default compiler and archiver options - updated by IngeDev
#-------------------------------------------------------------------------------
# Default compiler options
CC_DEF_OPTS     = %DEFAULT_CC_OPTIONS%
# Default assembler options
AS_DEF_OPTS     = %DEFAULT_AS_OPTIONS%
# Default archiver options
AR_DEF_OPTS     = %DEFAULT_AR_OPTIONS%

#-------------------------------------------------------------------------------
# Specific compiler and archiver options - updated by IngeDev
#-------------------------------------------------------------------------------
# Compiler options
CC_SPEC_OPTS    = %USER_CC_OPTIONS% %DEFAULT_DEFINE% %USER_DEFINES% $(INCLUDES_PATH)
# Assembler options
AS_SPEC_OPTS    = %USER_AS_OPTIONS% %DEFAULT_AS_DEFINE% %USER_AS_DEFINES% $(INCLUDES_PATH)
# Archiver options
AR_SPEC_OPTS    = %USER_AR_OPTIONS%

#-------------------------------------------------------------------------------
# Compiler and archiver options
# default + specific options
#-------------------------------------------------------------------------------
# Compiler options
CC_OPTS         = $(CC_DEF_OPTS) $(CC_SPEC_OPTS)
# Assembler options
AS_OPTS         = $(AS_DEF_OPTS) $(AS_SPEC_OPTS)
# Archiver options
AR_OPTS         = $(AR_DEF_OPTS) $(AR_SPEC_OPTS)

#-------------------------------------------------------------------------------
# SRC_OBJS is the list of the project object files - updated by IngeDev
#-------------------------------------------------------------------------------
SRC_OBJS        = \
%USER_OBJECT_LIST%

#-------------------------------------------------------------------------------
# Dependencies - updated by IngeDev
#-------------------------------------------------------------------------------
DEPENDENCIES = \
$(CFG_PATH)/%MAKEFILE_FILE_NAME% \
$(VARS_MK_DEPENDENCY) \
$(OS_VARS_MK_DEPENDENCY) \
$(PROJECTS_VARS_MK_DEPENDENCIES)

#===============================================================================
# Rule to make the project - updated by IngeDev
#===============================================================================
$(LIB_FILE): $(SRC_OBJS) $(LIBS)
	@$(PRINTF) "'$@' library generation in progress...\n"
	@$(RM) "$@"	
%ARCHIVE_SRC_OBJS_LINES%
ifneq "$(words $(LIBS))" "0"
	@$(RM) "$(ADD_LIBS_OBJ_PATH)"
	@$(MKDIR) "$(ADD_LIBS_OBJ_PATH)"
%ADD_LIB_FILES_EXTRACT_CMD_LINES%
	@$(PRINTF) "'$@' add additional libraries object files...\n"
%ADD_LIB_FILES_CMD_LINES%
	@$(RM) "$(ADD_LIBS_OBJ_PATH)"
endif
	$(RN) $@
ifneq "$(REMOVE_SYMBOLS)" "true"
	@$(PRINTF) "'$@' library file generated.\n"
endif

ifeq "$(REMOVE_SYMBOLS)" "true"
$(LIB_FILE_NO_SYMB): $(LIB_FILE)
	@$(PRINTF) "'$@' strip debug symbols in progress...\n"
	$(STRIP) $(LIB_FILE) -o $(LIB_FILE_NO_SYMB)
	@$(PRINTF) "'$@' library file generated.\n"
endif

#===============================================================================
# Rule for the compilation process - added by IngeDev
#===============================================================================
%COMPILER_FILES_RULES%
#===============================================================================
# Rule to display sub-project name and configuration name
#===============================================================================
.PHONY: displayInfo
displayInfo:
	@$(PRINTF) "                                     *-*-*\n"
	@$(PRINTF) "--- Project '$(PROJECT_NAME)', Sub-project '$(SUB_PRJ_NAME)', Configuration '$(CFG_NAME)' ---\n"

#===============================================================================
# Rule to display a message if the debug is activated - updated by IngeDev
#===============================================================================
.PHONY: displayDebugMessage
displayDebugMessage:
%PRINT_DEBUG_MESSAGE%

#===============================================================================
# Rule to create output directories if it not already exist
#===============================================================================
.PHONY: createOutputDirs
createOutputDirs:
	@$(MKDIR) "$(OBJ_PATH)"
	@$(MKDIR) "$(BIN_PATH)"

#===============================================================================
# Make build rule
#===============================================================================
.PHONY: build
ifeq "$(REMOVE_SYMBOLS)" "true"
build: displayDebugMessage displayInfo createOutputDirs $(LIB_FILE_NO_SYMB)
else
build: displayDebugMessage displayInfo createOutputDirs $(LIB_FILE)
endif
	@$(PRINTF) "done!\n"

#===============================================================================
# Make clean rule
#===============================================================================
.PHONY: clean
clean: displayInfo
	@$(PRINTF) "deleting intermediate files...\n"
ifneq "$(wildcard $(OBJ_PATH)/*.*)" ""
	@$(RM) "$(OBJ_PATH)/*.*"
endif
	@$(PRINTF) "done!\n"
