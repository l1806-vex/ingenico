#*******************************************************************************
#* %MAKEFILE_FILE_NAME%
#*------------------------------------------------------------------------------
#* Makefile used to generate all the binaries according to a configuration
#* This file was automatically generated by IngeDev. Please, do not edit!
#*******************************************************************************

#-------------------------------------------------------------------------------
# Include variables list set in the runtime-workspace
#-------------------------------------------------------------------------------
include vars.mk

#-------------------------------------------------------------------------------
# Include projects variables list - updated by IngeDev
#-------------------------------------------------------------------------------
%PROJECTS_VARS_MK_FILE%
#-------------------------------------------------------------------------------
# Include added common modules without sources makefiles - updated by IngeDev
#-------------------------------------------------------------------------------
%ADDED_COM_MOD_MK_FILES%
#-------------------------------------------------------------------------------
# List of available configurations - updated by IngeDev
#-------------------------------------------------------------------------------
# All configurations list
CONFIGS_LIST      = %CONFIGS_LIST%
# Configurations list for simulation only
CONFIGS_SIMU_LIST = %CONFIGS_SIMU_LIST%

#-------------------------------------------------------------------------------
# Check if configuration is known
#-------------------------------------------------------------------------------
ifeq "$(filter $(CFG_NAME),$(CONFIGS_LIST))" ""
$(error The configuration $(CFG_NAME) does not exists!)
endif

#-------------------------------------------------------------------------------
# General constants
#-------------------------------------------------------------------------------
EMPTY :=
SPACE := $(EMPTY) $(EMPTY)

#-------------------------------------------------------------------------------
# Directories - updated by IngeDev
#-------------------------------------------------------------------------------
# Binaries directory
BIN_DIR         = %BIN_DIR%
# Object directory
OBJ_DIR         = %OBJ_DIR%
# Configuration directory
CFG_DIR         = %CFG_DIR%

#-------------------------------------------------------------------------------
# Output files path for the current config
#-------------------------------------------------------------------------------
# Binary files path
BIN_PATH        = $(BIN_DIR)/$(CFG_NAME)
# Configuration files path
CFG_PATH        = $(CFG_DIR)/$(CFG_NAME)

#-------------------------------------------------------------------------------
# VB Script executable
#-------------------------------------------------------------------------------
VBSCRIPT        = "$(SystemRoot)/system32/cscript.exe" /nologo

#-------------------------------------------------------------------------------
# Win32 VBS script path and name - updated by IngeDev
#-------------------------------------------------------------------------------
VBS_PATH_NAME   = %VBS_PATH_NAME%

#-------------------------------------------------------------------------------
# Gnu Win32 tools
#-------------------------------------------------------------------------------
# Remove tool
RM              = rm.exe -fr
# Make directory tool
MKDIR           = mkdir.exe -p
# Copy tool
CP              = cp.exe
# Printf tool
PRINTF          = printf.exe
# Zip tool
ZIP             = 7za.exe -tzip

#===============================================================================
# Rule to make the project
#===============================================================================

#===============================================================================
# Make build rules - updated by IngeDev
#===============================================================================
%BUILDDWLPACKAGE_RULES%
%BUILDSIMUPACKAGE_RULES%

$(BIN_PATH)/$(BUILDDWLPACKAGE_NAME): $(BUILDDWLPACKAGE_DEP)
	@$(PRINTF) "                                     *-*-*\n"
<<if dataRootPathValid
	"$(MAKE)" -f"data.mk" PACKAGE_APP_NAME=$(BUILDDWLPACKAGE_APP_NAME) build
	$(VBSCRIPT) "$(VBS_PATH_NAME)" "$(BUILDDWLPACKAGE_NAME)" "$(BIN_PATH)" "$(BUILDDWLPACKAGE_BIN_CFG_FILE)" "%DWL_DATA_ROOT_TMP_PATH%"
<<else
	$(VBSCRIPT) "$(VBS_PATH_NAME)" "$(BUILDDWLPACKAGE_NAME)" "$(BIN_PATH)" "$(BUILDDWLPACKAGE_BIN_CFG_FILE)"
<<endif
	@$(RM) "$(subst \ , ,$(subst :/,:\,$(BIN_PATH)/$(BUILDDWLPACKAGE_APP_NAME)))"
	@$(PRINTF) "Download package '$@' for application '$(BUILDDWLPACKAGE_APP_NAME)' successfully created.\n"

$(BIN_PATH)/$(BUILDSIMUPACKAGE_NAME): $(BUILDSIMUPACKAGE_DEP)
	@$(PRINTF) "                                     *-*-*\n"
	@$(RM) "$@" 
%ZIP_FILES_CMDS%
	@$(PRINTF) "Simulation package '$@' for application '$(BUILDSIMUPACKAGE_APP_NAME)' successfully created.\n"
	
#-------------------------------------------------------------------------------
# Pre & Post build commands - updated by IngeDev
#-------------------------------------------------------------------------------
.PHONY: prebuild
prebuild:
%PREBUILD_COMMAND_BY_CONFIG%
.PHONY: postbuild
postbuild:
%POSTBUILD_COMMAND_BY_CONFIG%

.PHONY: build_all
ifeq "$(filter $(CFG_NAME),$(CONFIGS_SIMU_LIST))" ""
build_all: | prebuild %ORDERED_BUILD_RULES_LIST% $(BIN_PATH)/$(BUILDDWLPACKAGE_NAME) postbuild
else
build_all: | prebuild %ORDERED_BUILD_RULES_LIST% $(BIN_PATH)/$(BUILDSIMUPACKAGE_NAME) postbuild
endif

%BUILD_RULES%
#===============================================================================
# Make clean rules - updated by IngeDev
#===============================================================================
.PHONY: clean_all
ifeq "$(filter $(CFG_NAME),$(CONFIGS_SIMU_LIST))" ""
clean_all: %CLEAN_RULES_LIST% cleanDwlPackage
else
clean_all: %CLEAN_RULES_LIST% cleanSimuPackage
endif
	@$(PRINTF) "                                     *-*-*\n"
	@$(PRINTF) "clean done!\n"

.PHONY: cleanDwlPackage
cleanDwlPackage:
	@$(PRINTF) "                                     *-*-*\n"
%CLEANDWLPACKAGE_RULES%
	@$(PRINTF) "done!\n"

.PHONY: cleanSimuPackage
cleanSimuPackage:
	@$(PRINTF) "                                     *-*-*\n"
%CLEANSIMUPACKAGE_RULES%
	@$(PRINTF) "done!\n"

%CLEAN_RULES%
